# Un projet d'étude reproductible avec `targets`

`targets` est une librairie qui permet d'automatiser un ensemble de traitement en R, qui peut être particulièrement intéressante dans le cas d'un projet d'étude entièrement en R qui vise à une forte reproductibilité.
Par exemple, une étude qui se structurerait suivant les étapes suivantes: 0 Charger les données, 1. Traiter les données, 2. Produire des résultats, 3. Représenter les résultats. 

## Pourquoi utiliser `targets`?

1. Viser la reproductibilité de l'ensemble des étapes de traitement, en tout en minimisant au strict nécessaire la répétition de ces étapes, parfois longues
2. adapter des bonnes pratiques de développement en R par l'usage (modulariser son code, assurer la lisibilité des étapes successives du traitement..)

Target permets de définir une chaîne de traitement avec:

* sauvegarde automatique des résultats intermédiaires, des "targets"
* traçabilité de ces résultats intermédiaires par targets: lors de la répétition de la chaîne de traitement, ils ne sont mobilisés que si ils sont reproductibles.
*  si une fonction ou un input nécessaire au calcul d'une target est modifié, targets repère automatiquement les étapes à reconduire, et seulement celles-ci

Ainsi, le lancement du traitement et la vérification de la reproductibilité sont effectués ensemble, au cours du développement du projet, et vérifier la reproductibilité ne revient pas à 'tout relancer' de 0 (ce qui représente un coût élevé).`targets` automatise le travail d'aller-retour dans les étapes d'une étude (j'ai modifié l'étape 1, il faut donc que je relance l'étape 2 qui en dépend...), qui est en pratique rarement mené de façon linéaire, avec des étapes multiples dont on peut perdre de vue les intrications.

::: {.recommandation}

:::

## Quelques détails sur comment réaliser la tâche avec les outils recommandés

::: {.conseil}

Cette boîte colorée sert à donner un conseil. Son usage n'est évidemment pas obligatoire.

:::

::: {.remarque}

Cette boîte colorée sert à faire une remarque. Son usage n'est évidemment pas obligatoire.

:::

### Réaliser la tâche, cas 1

Lorsqu'on est débutant, il faut utiliser la fonction `super_fonction()` du *package* `super_package`.

La fonction `super_fonction()` fonctionne comme ceci par défaut : blabla.

La fonction `super_fonction()` propose beaucoup d'options :

* `option1` : blabla ;
* `option2` : blabla ;
* `option3` : blabla.

Voici un premier exemple de code (le plus simple possible, en utilisant des données facilement disponibles sur le site de l'Insee) :

```{r, eval = FALSE}
library(super_package)
output <- super_fonction(arguments)
```

Ne pas oublier d'expliquer ce qu'on obtient comme output.

Voici un second exemple de code, avec des options un peu plus avancées :

```{r, eval = FALSE}
output <- super_fonction(arguments et options)
```


### Réaliser la tâche, cas 2

Lorsqu'on est plus avancé, on peut utiliser la fonction `hyper_fonction()` du *package* `hyper_package`.

* Comportement par défaut ;
* Principales options ;
* Exemples de code.

## Quelques bonnes pratiques

Quelques conseils généraux sur la façon de s'y prendre.

* Faut-il préprocesser les données avant de réaliser la tâche ;
* Comment minimiser les temps de calculs/la charge en RAM.

## Sources

Si le rédacteur de la fiche a réutilisé des ressources externes en français disponible en licence libre, il faut indiquer ici l'URL des ressources, le nom des auteurs et la licence de réutilisation de ces ressources.

## Pour en savoir plus

* la documentation des *packages* ;
* les vignettes et *cheatsheets* si elles existent ;
* les formations proposées par l'Insee ;
* les formations/tutoriels disponibles sur internet.

Dans la mesure du possible, il faut veiller à proposer des ressources en français.

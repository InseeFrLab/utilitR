<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.43">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>14&nbsp; Importer des fichiers issus de tableurs (Excel, Calc)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../03_Fiches_thematiques/Fiche_import_fichiers_parquet.html" rel="next">
<link href="../03_Fiches_thematiques/Fiche_import_tables_sas.html" rel="prev">
<link href="../resources/logo-utilitr.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-d4d76bf8491c20bad77d141916dc28e1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-4379b0ccadffce622b03caf4c46266b3.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-b4e8633835c5b832926fbdf0b24b9738.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-6d795b6992d62256d9673cc2ffc824d6.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://hypothes.is/embed.js"></script><script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>
</head>
<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../resources/logo-utilitr.png" alt="Logo du projet utilitR" class="navbar-logo"></a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link active" href="../01_R_Insee/presentation_utilitr.html" aria-current="page"> 
<span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../03_Fiches_thematiques/Fiche_rprojects.html"> 
<span class="menu-text">Mener un projet statistique</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../03_Fiches_thematiques/Fiche_import_fichiers_plats.html"> 
<span class="menu-text">Importer des données</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../03_Fiches_thematiques/Fiche_tidyverse.html"> 
<span class="menu-text">Choisir son paradigme</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../03_Fiches_thematiques/Fiche_joindre_donnees.html"> 
<span class="menu-text">Manipuler des données</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../03_Fiches_thematiques/Fiche_graphiques.html"> 
<span class="menu-text">Produire des sorties</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../02_Bonnes_pratiques/01-qualite-code.html"> 
<span class="menu-text">Bonnes pratiques</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/InseeFrLab/utilitR" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../03_Fiches_thematiques/Fiche_import_fichiers_plats.html">Importer des données avec R</a></li><li class="breadcrumb-item"><a href="../03_Fiches_thematiques/Fiche_import_tableurs.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Importer des fichiers issus de tableurs (Excel, Calc)</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../resources/logo-utilitr.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none"></a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title"><span class="bigger120"><code>utilitR</code> ne couvre pas tous les besoin, loin s’en faut!</span></span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01_R_Insee/presentation_utilitr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Présentation du projet <code>utilitR</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01_R_Insee/Fiche_utiliser_utilitR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Comment utiliser la documentation <code>utilitR</code></span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Mener un projet statistique avec R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_rprojects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Utiliser les projets <code>RStudio</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_git_utilisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Utiliser <code>Git</code> avec RStudio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01_R_Insee/Fiche_installer_packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Utiliser des <em>packages</em> <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_comment_choisir_un_package.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Comment choisir un <em>package</em> ?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_gerer_dependances.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Gérer les dépendances</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_se_documenter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Se documenter sur <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_resoudre_un_probleme.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Résoudre un problème avec <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_targets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Construire une chaîne de traitement reproductible avec <code>targets</code></span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Importer des données avec R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_import_fichiers_plats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Importer des fichiers plats (<code>.csv</code>, <code>.tsv</code>, <code>.txt</code>)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_import_tables_sas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Importer des tables SAS®</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_import_tableurs.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Importer des fichiers issus de tableurs (Excel, Calc)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_import_fichiers_parquet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Lire et écrire des fichiers Parquet</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_api.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Travailler avec des API</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_connexion_bdd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Se connecter à une base de données</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Choisir son paradigme d’analyse des données avec R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Manipuler des données avec le <code>tidyverse</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_datatable.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Manipuler des données avec <code>data.table</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_arrow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Manipuler des données avec <code>arrow</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_duckdb.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Manipuler des données avec <code>duckdb</code></span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Manipuler des données avec R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_joindre_donnees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Joindre des tables de données</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_donnees_textuelles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Manipuler des données textuelles</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Utiliser des données d’enquêtes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_donnees_spatiales.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Manipuler des données spatiales</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_donnees_temporelles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Manipuler des données temporelles</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_analyse_de_donnees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">L’analyse de données (ACP, ACM, ACF…)</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Produire des sorties avec R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_graphiques.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Faire des graphiques avec <code>ggplot2</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_rmarkdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Produire des documents avec <code>R Markdown</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_rmarkdown_param_report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Produire des rapports automatisés avec <code>R Markdown</code></span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Bonnes pratiques</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02_Bonnes_pratiques/01-qualite-code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Qualité du code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02_Bonnes_pratiques/02-structure-code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Structure des projets</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Éléments de configuration</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01_R_Insee/Fiche_utiliser_Rstudio_AUSv3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Utiliser RStudio sur l’environnement AUSv3</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_Fiches_thematiques/Fiche_configurer_git.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Configurer <code>Git</code> sur son poste de travail</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01_R_Insee/Fiche-personnaliser-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Personnaliser la configuration de <code>R</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01_R_Insee/Fiche_utiliser_ressources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Superviser sa session <code>R</code></span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#t%C3%A2ches-concern%C3%A9es-et-recommandations" id="toc-tâches-concernées-et-recommandations" class="nav-link active" data-scroll-target="#t%C3%A2ches-concern%C3%A9es-et-recommandations"><span class="header-section-number">14.1</span> Tâches concernées et recommandations</a></li>
  <li>
<a href="#importer-un-fichier-xlsx-ou-xls" id="toc-importer-un-fichier-xlsx-ou-xls" class="nav-link" data-scroll-target="#importer-un-fichier-xlsx-ou-xls"><span class="header-section-number">14.2</span> Importer un fichier <code>xlsx</code> ou <code>xls</code></a>
  <ul class="collapse">
<li><a href="#importer-un-fichier-xlsx-ou-xls-avec-linterface-graphique-de-rstudio" id="toc-importer-un-fichier-xlsx-ou-xls-avec-linterface-graphique-de-rstudio" class="nav-link" data-scroll-target="#importer-un-fichier-xlsx-ou-xls-avec-linterface-graphique-de-rstudio"><span class="header-section-number">14.2.1</span> Importer un fichier <code>xlsx</code> ou <code>xls</code> avec l’interface graphique de RStudio</a></li>
  <li><a href="#importer-un-fichier-xlsx-avec-le-package-openxlsx" id="toc-importer-un-fichier-xlsx-avec-le-package-openxlsx" class="nav-link" data-scroll-target="#importer-un-fichier-xlsx-avec-le-package-openxlsx"><span class="header-section-number">14.2.2</span> Importer un fichier <code>xlsx</code> avec le <em>package</em> <code>openxlsx</code></a></li>
  <li><a href="#importer-un-fichier-xls-avec-le-package-readxl" id="toc-importer-un-fichier-xls-avec-le-package-readxl" class="nav-link" data-scroll-target="#importer-un-fichier-xls-avec-le-package-readxl"><span class="header-section-number">14.2.3</span> Importer un fichier <code>xls</code> avec le <em>package</em> <code>readxl</code></a></li>
  </ul>
</li>
  <li>
<a href="#importer-un-fichier-ods-avec-le-package-readods" id="toc-importer-un-fichier-ods-avec-le-package-readods" class="nav-link" data-scroll-target="#importer-un-fichier-ods-avec-le-package-readods"><span class="header-section-number">14.3</span> Importer un fichier <code>ods</code> avec le <em>package</em> <code>readODS</code></a>
  <ul class="collapse">
<li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">14.3.1</span> Introduction</a></li>
  <li><a href="#comment-utiliser-la-fonction-read_ods" id="toc-comment-utiliser-la-fonction-read_ods" class="nav-link" data-scroll-target="#comment-utiliser-la-fonction-read_ods"><span class="header-section-number">14.3.2</span> Comment utiliser la fonction <code>read_ods()</code></a></li>
  <li><a href="#quelques-exemples-2" id="toc-quelques-exemples-2" class="nav-link" data-scroll-target="#quelques-exemples-2"><span class="header-section-number">14.3.3</span> Quelques exemples</a></li>
  </ul>
</li>
  <li><a href="#RessourcesImportXLSX" id="toc-RessourcesImportXLSX" class="nav-link" data-scroll-target="#RessourcesImportXLSX"><span class="header-section-number">14.4</span> Pour en savoir plus</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/InseeFrLab/utilitR/edit/master/03_Fiches_thematiques/Fiche_import_tableurs.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/InseeFrLab/utilitR/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../03_Fiches_thematiques/Fiche_import_fichiers_plats.html">Importer des données avec R</a></li><li class="breadcrumb-item"><a href="../03_Fiches_thematiques/Fiche_import_tableurs.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Importer des fichiers issus de tableurs (Excel, Calc)</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="importxl" class="quarto-section-identifier"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Importer des fichiers issus de tableurs (Excel, Calc)</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="tâches-concernées-et-recommandations" class="level2" data-number="14.1"><h2 data-number="14.1" class="anchored" data-anchor-id="tâches-concernées-et-recommandations">
<span class="header-section-number">14.1</span> Tâches concernées et recommandations</h2>
<p>L’utilisateur souhaite importer dans <code>R</code> des données issues de tableurs (extension type <code>xls</code>, <code>xlsx</code> ou <code>ods</code>).</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tâche concernée et recommandation
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Il est recommandé d’utiliser la fonction <code><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx()</a></code> du <em>package</em> <code>openxlsx</code> pour importer des fichiers <code>xlsx</code>.</strong></li>
<li>
<strong>Il est recommandé d’utiliser la fonction <code><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel()</a></code> du <em>package</em> <code>readxl</code> pour importer des fichiers <code>xlsx</code> ou <code>xls</code>.</strong> Pour les fichiers <code>xlsx</code>, la fonction <code><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx()</a></code> du <em>package</em> <code>openxlsx</code> peut également être utilisée même s’il est un peu moins performante que <code><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel()</a></code> sur les gros fichiers (voir <a href="https://stackoverflow.com/questions/44538199/fast-way-to-read-xlsx-files-into-r">ici</a>).</li>
<li><strong>Il est recommandé d’utiliser la fonction <code>read_ods</code> du <em>package</em> <code>readODS</code> pour importer des fichiers <code>ods</code>.</strong></li>
</ul>
<p>Il est déconseillé d’utiliser le <em>package</em> <code>xlsx</code>.</p>
</div>
</div>
</section><section id="importer-un-fichier-xlsx-ou-xls" class="level2" data-number="14.2"><h2 data-number="14.2" class="anchored" data-anchor-id="importer-un-fichier-xlsx-ou-xls">
<span class="header-section-number">14.2</span> Importer un fichier <code>xlsx</code> ou <code>xls</code>
</h2>
<p>L’importation de fichiers <code>xlsx</code> et <code>xls</code> va être illustré à partir de deux jeux de données créés à partir de données présentes sur le site de l’Insee, en formats <code>xls</code> et <code>xlsx</code>. Pour reproduire les exemples ci-dessous, vous devez :</p>
<ul>
<li>télécharger <a href="https://github.com/InseeFrLab/utilitR/tree/master/import_donnees_tabulees_tests">les jeux de données ici</a> puis le sauvegarder sur votre poste ;</li>
<li>définir dans <code>R</code> les chemins des fichiers nommés <code>chemin_xls</code> et <code>chemin_xlsx</code>. Voici un exemple :</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Attention, vous devez adapter le chemin des fichiers à votre environnement de travail</span></span>
<span><span class="va">chemin_xls</span>  <span class="op">&lt;-</span> <span class="st">"C:/Users/mon_IDEP_Insee/Dossier_utilitR/mes_donnees/mes_donnees.xls"</span>  </span>
<span><span class="va">chemin_xlsx</span> <span class="op">&lt;-</span> <span class="st">"C:/Users/mon_IDEP_Insee/Dossier_utilitR/mes_donnees/mes_donnees.xlsx"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Si vous êtes complètement débutants en <code>R</code>, il est recommandé d’utiliser l’utilitaire d’importation de <code>RStudio</code> présentée ci-dessous. Une fois que les données sont correctement importées, vous pourrez copier-coller le code dans votre script <code>R</code> et vous familiariser avec les fonctions des <em>packages</em> <code>openxlsx</code> et <code>readxl</code>.</p>
</div>
</div>
<section id="importer-un-fichier-xlsx-ou-xls-avec-linterface-graphique-de-rstudio" class="level3" data-number="14.2.1"><h3 data-number="14.2.1" class="anchored" data-anchor-id="importer-un-fichier-xlsx-ou-xls-avec-linterface-graphique-de-rstudio">
<span class="header-section-number">14.2.1</span> Importer un fichier <code>xlsx</code> ou <code>xls</code> avec l’interface graphique de RStudio</h3>
<p><strong>RStudio propose une interface graphique très commode pour lire des fichiers <code>xls</code> et <code>xlsx</code></strong> (mais aussi des tables <code>SAS</code> ou des fichiers <code>csv</code>, mais pas les <code>ods</code>), reposant sur les packages <code>haven</code> et <code>readxl</code>. Le grand intérêt de cette interface est qu’elle fournit le code utilisé pour importer les données. Vous pouvez donc le copier dans vos scripts pour le réutiliser, et ainsi vous familiariser avec les fonctions d’importation.</p>
<p>On accède à cette interface avec : <code>File &gt; Import Dataset &gt; From Excel...</code>. Les différents menus permettent notamment de sélectionner l’onglet et la zone à importer et de nommer la table d’affectation.</p>
<p>Dans ce premier exemple, on importe l’onglet par défaut (<code>Sheet1</code>), de la table <code>mes_donnees.xlsx</code> (<code>File/Url</code>) qu’on nomme <code>mes_donnees</code> (<code>Name</code>). On garde la première ligne du fichier comme noms de colonnes (<code>First Row as Names</code>). Vous pouvez voir que le code d’importation apparaît en bas à droite, dans la cellule <code>Code Preview</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="../pics/importer_tableurs/1_import_IHM.png" class="img-fluid figure-img"></p>
<figcaption>Interface d’importation de RStudio : Exemple 1</figcaption></figure>
</div>
<p>Dans l’exemple suivant, on n’importe qu’une plage de données (<code>A1:D5</code>) de l’onglet nommé <code>Sheet3</code> (<code>Sheet</code>), et on remplace les valeurs manquantes par <code>1904</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="../pics/importer_tableurs/2_import_IHM_avec_param_sheet_range_NA.png" class="img-fluid figure-img"></p>
<figcaption>Interface d’importation de RStudio : Exemple 2</figcaption></figure>
</div>
</section><section id="importer-un-fichier-xlsx-avec-le-package-openxlsx" class="level3" data-number="14.2.2"><h3 data-number="14.2.2" class="anchored" data-anchor-id="importer-un-fichier-xlsx-avec-le-package-openxlsx">
<span class="header-section-number">14.2.2</span> Importer un fichier <code>xlsx</code> avec le <em>package</em> <code>openxlsx</code>
</h3>
<p>Pour importer un fichier au format <code>xlsx</code>, la fonction <code><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx()</a></code> du <em>package</em> <code>openxlsx</code> peut être utilisée pour des fichiers de tailles raisonnables. Cette fonction permet de charger les données du tableur dans un <code>data.frame</code>. Il ne faut pas oublier de charger le <em>package</em> avec <code>library</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ycphs.github.io/openxlsx/index.html">openxlsx</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="comment-utiliser-la-fonction-read.xlsx" class="level4" data-number="14.2.2.1"><h4 data-number="14.2.2.1" class="anchored" data-anchor-id="comment-utiliser-la-fonction-read.xlsx">
<span class="header-section-number">14.2.2.1</span> Comment utiliser la fonction <code>read.xlsx()</code>
</h4>
<p>Voici les principaux arguments et options de <code><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx()</a></code> :</p>
<table class="caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 17%">
<col style="width: 69%">
</colgroup>
<thead><tr class="header">
<th>Argument</th>
<th>Valeur par défaut</th>
<th>Fonction</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>xlsxFile</code></td>
<td>Aucune</td>
<td>Chemin d’accès vers un objet classeur ou une url vers un fichier <code>xlsx</code> à importer</td>
</tr>
<tr class="even">
<td><code>sheet</code></td>
<td><code>1</code></td>
<td>Onglet à importer. Soit le nom de l’onglet, soit un numéro de l’onglet</td>
</tr>
<tr class="odd">
<td><code>startRow</code></td>
<td><code>1</code></td>
<td>Ligne à partir de laquelle les données sont importées. Les lignes vides en haut d’un fichier sont toujours ignorées, quelle que soit la valeur de <code>startRow</code>
</td>
</tr>
<tr class="even">
<td><code>colNames</code></td>
<td><code>TRUE</code></td>
<td>Si <code>TRUE</code>, la première ligne de données sera utilisée comme nom de colonnes</td>
</tr>
<tr class="odd">
<td><code>rowNames</code></td>
<td><code>FALSE</code></td>
<td>Si <code>TRUE</code>, la première colonne de données sera utilisée comme noms de lignes</td>
</tr>
<tr class="even">
<td><code>detectDates</code></td>
<td><code>FALSE</code></td>
<td>Si <code>TRUE</code>, <code>R</code> essaiera de reconnaître les dates et d’effectuer la conversion</td>
</tr>
<tr class="odd">
<td><code>skipEmptyRows</code></td>
<td><code>TRUE</code></td>
<td>Si <code>TRUE</code>, les lignes vides sont ignorées, sinon les lignes vides après la première ligne contenant les données renverront une ligne de <code>NA</code>
</td>
</tr>
<tr class="even">
<td><code>skipEmptyCols</code></td>
<td><code>FALSE</code></td>
<td>Si <code>TRUE</code>, les colonnes vides sont ignorées</td>
</tr>
<tr class="odd">
<td><code>check.names</code></td>
<td><code>FALSE</code></td>
<td>Si <code>TRUE</code>, les noms des variables dans la trame de données sont vérifiés et modifiés pour s’assurer qu’ils sont des noms de variables valides</td>
</tr>
<tr class="even">
<td><code>sep.names</code></td>
<td>“.”</td>
<td>Un caractère qui remplace les blancs dans les noms de colonne</td>
</tr>
</tbody>
</table></section><section id="quelques-exemples" class="level4" data-number="14.2.2.2"><h4 data-number="14.2.2.2" class="anchored" data-anchor-id="quelques-exemples">
<span class="header-section-number">14.2.2.2</span> Quelques exemples</h4>
<p>Les exemples qui suivent vous présentent l’utilisation de la fonction <code>read.xlsx</code> dans quelques cas courants.</p>
<ul>
<li>
<strong>Utilisation la plus simple</strong> : on importe toutes les données du premier onglet, en supposant que la première ligne contient les noms de variables.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mesDonnees</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span>xlsxFile <span class="op">=</span> <span class="va">chemin_xlsx</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mesDonnees</span>, <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sheet1 Année Population.en.milieu.d'année Mariages Divorces.prononcés.(a)
1      1  1901                     40710000   316540                   9000
2      2  1902                     40810000   306682                   9600
3      3  1903                     40910000   308510                  10400
  Naissances.vivantes Décès.tous.âges.(b) Décès.de.moins.d'un.an
1              917075              825315                 137310
2              904434              801379                 130086
3              884498              794566                 129247
  Excédent.naturel Nuptialité.(c) Natalité Mortalité Accroissement.naturel
1            91760            7.8     22.5      20.3                   2.2
2           103055            7.5     22.2      19.6                   2.6
3            89932            7.5     21.6      19.4                   2.2
  Taux.de.mortalité.infantile.pour.1.000.naissances.vivantes       date
1                                                      151.1 2020-06-22
2                                                      143.3 2020-06-22
3                                                      145.3 2020-06-22</code></pre>
</div>
</div>
<ul>
<li>
<strong>Définir l’onglet à importer</strong> : on importe toutes les données du troisième onglet, en supposant que la première ligne contient les noms de variables. On définit l’onglet à importer avec le paramètre <code>sheet</code> en précisant soit le nom de l’onglet soit son index (sa position dans le fichier). Il est conseillé d’utiliser le nom de l’onglet plutôt que sa position.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Chargement du 3ème onglet</span></span>
<span><span class="va">mesDonnees</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span>xlsxFile <span class="op">=</span> <span class="va">chemin_xlsx</span>, sheet <span class="op">=</span> <span class="st">"Sheet3"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>La fonction <code><a href="https://rdrr.io/pkg/openxlsx/man/getSheetNames.html">openxlsx::getSheetNames()</a></code> permet de récupérer les noms des onglets du fichier sans avoir à l’ouvrir.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/getSheetNames.html">getSheetNames</a></span><span class="op">(</span><span class="va">chemin_xlsx</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sheet1" "Sheet2" "Sheet3"</code></pre>
</div>
</div>
</div>
</div>
<ul>
<li>
<strong>Préciser où débute la sélection</strong> : par défaut, on importe les données à partir de la première ligne de l’onglet spécifié. On peut, avec le paramètre <code>startRow</code>, définir la ligne de début d’importation. Dans l’exemple ci-dessous, on n’importe les données qu’à compter de la troisième ligne. Si on laisse le paramètre <code>colNames = TRUE</code>, la première de ces lignes est considérée comme noms de colonnes, ce qui peut donner des résultats absurdes. Si c’est le cas, on peut utiliser le paramètre <code>colNames=FALSE</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mesDonnees</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span>xlsxFile <span class="op">=</span> <span class="va">chemin_xlsx</span>, startRow<span class="op">=</span><span class="fl">3</span>, colNames<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># Les 4 premières lignes du data.frame</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mesDonnees</span>, <span class="fl">4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  X1   X2       X3     X4    X5     X6     X7     X8     X9 X10  X11  X12 X13
1  2 1902 40810000 306682  9600 904434 801379 130086 103055 7.5 22.2 19.6 2.6
2  3 1903 40910000 308510 10400 884498 794566 129247  89932 7.5 21.6 19.4 2.2
3  4 1904 41000000 312134 11100 877091 802536 134437  74555 7.6 21.4 19.6 1.8
4  5 1905 41050000 316195 11100 865604 812338 125533  53266 7.7 21.1 19.8 1.3
    X14        X15
1 143.3 2020-06-22
2 145.3 2020-06-22
3 152.9 2020-06-22
4 144.5 2020-06-22</code></pre>
</div>
</div>
<ul>
<li>
<strong>Sélectionner les lignes et colonnes à importer</strong> : on peut définir les lignes et colonnes qu’on souhaite importer en le précisant, avec un vecteur numérique, avec les paramètres <code>rows</code> et <code>cols</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mesDonnees</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span>xlsxFile <span class="op">=</span> <span class="va">chemin_xlsx</span>, rows<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">9</span><span class="op">)</span>, cols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mesDonnees</span>, <span class="fl">4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sheet1 Population.en.milieu.d'année Mariages
1      3                     40910000   308510
2      4                     41000000   312134
3      5                     41050000   316195
4      8                     41190000   328877</code></pre>
</div>
</div>
<ul>
<li>
<strong>Vérification du respect des normes syntaxiques dans les noms de variables</strong> : les noms de colonnes dans un fichier Excel ne peuvent pas toujours être utilisés directement comme noms de variables dans <code>R</code>. Les paramètres <code>check.names</code> et <code>sep.names</code> permettent de modifier les noms de variables pour les adapter aux règles de bonnes pratiques syntaxiques :
<ul>
<li>Le paramètre <code>check.names=TRUE</code> modifie les noms de variables qui posent problème. Par exemple, <code>nom-de-variable</code> dans Excel devient <code>nom.de.variable</code> dans <code>R</code>.</li>
<li>Le paramètre <code>sep.names</code> permet de définir le caractère par lequel remplacer les espaces.</li>
</ul>
</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Pour l’exportation de données au format <code>xlsx</code>, le <em>package</em> <code>openxlsx</code> est à privilégier car il présente de multiples options très pratiques pour personnaliser les exports. Les deux vignettes du package sur ce sujet apportent quelques exemples des potentialités d’écriture de classeurs <code>xlsx</code>. <a href="https://ycphs.github.io/openxlsx/articles/Introduction.html">La première</a> présente notamment l’utilisation de la fonction <code><a href="https://rdrr.io/pkg/openxlsx/man/write.xlsx.html">write.xlsx()</a></code> et la seconde illustre quelques possibilités autour de la fonction <code><a href="https://rdrr.io/pkg/openxlsx/man/writeData.html">writeData()</a></code>.</p>
</div>
</div>
</section></section><section id="importer-un-fichier-xls-avec-le-package-readxl" class="level3" data-number="14.2.3"><h3 data-number="14.2.3" class="anchored" data-anchor-id="importer-un-fichier-xls-avec-le-package-readxl">
<span class="header-section-number">14.2.3</span> Importer un fichier <code>xls</code> avec le <em>package</em> <code>readxl</code>
</h3>
<p>Pour importer un fichier au format <code>xls</code> ou <code>xlsx</code>, il est recommandé d’utiliser la <em>fonction</em> <code><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel()</a></code> du <em>package</em> <code>readxl</code>. Cette fonction permet en effet d’importer des fichiers volumineux de manière plus rapide que le package <code>openxlsx</code>. Les données du tableur sont alors chargées dans un <code>tibble</code> (voir la fiche [Manipuler des données avec le <code>tidyverse</code>] pour en apprendre davantage sur le <code>tibble</code>). Il ne faut pas oublier de charger le <em>package</em> avec <code>library</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="comment-utiliser-la-fonction-read_excel" class="level4" data-number="14.2.3.1"><h4 data-number="14.2.3.1" class="anchored" data-anchor-id="comment-utiliser-la-fonction-read_excel">
<span class="header-section-number">14.2.3.1</span> Comment utiliser la fonction <code>read_excel()</code>
</h4>
<p>Voici les principaux arguments et options de <code><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel()</a></code> :</p>
<table class="caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 17%">
<col style="width: 69%">
</colgroup>
<thead><tr class="header">
<th>Argument</th>
<th>Valeur par défaut</th>
<th>Fonction</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>path</code></td>
<td>Aucune</td>
<td>Chemin d’accès au fichier xls / xlsx à importer</td>
</tr>
<tr class="even">
<td><code>sheet</code></td>
<td><code>NULL</code></td>
<td>Onglet à importer Soit le nom de l’onglet, soit la position de l’onglet. Par défaut, sélectionne le premier onglet du fichier</td>
</tr>
<tr class="odd">
<td><code>range</code></td>
<td><code>NULL</code></td>
<td>Une plage de cellules à lire. Accepte des plages Excel typiques comme <code>"B3:D87"</code>et des plages avec le nom de l’onglet comme <code>"Budget! B2:G14"</code>
</td>
</tr>
<tr class="even">
<td><code>col_names</code></td>
<td><code>TRUE</code></td>
<td>
<code>TRUE</code> pour utiliser la première ligne comme noms de colonne, <code>FALSE</code> pour obtenir les noms par défaut ou un vecteur de caractères donnant un nom à chaque colonne</td>
</tr>
<tr class="odd">
<td><code>col_types</code></td>
<td><code>NULL</code></td>
<td>Préciser le type des colonnes. Si <code>col_types = NULL</code>, <code>readxl</code> essaie de deviner le type des colonnes. Voir <code><a href="https://readxl.tidyverse.org/reference/read_excel.html">?readxl::read_xls</a></code> pour l’usage de cette option</td>
</tr>
<tr class="even">
<td><code>na</code></td>
<td>“”</td>
<td>Vecteur de chaînes de caractères à interpréter comme des valeurs manquantes</td>
</tr>
<tr class="odd">
<td><code>skip</code></td>
<td><code>0</code></td>
<td>Nombre de lignes à ignorer avant d’importer les données</td>
</tr>
<tr class="even">
<td><code>n_max</code></td>
<td><code>Inf</code></td>
<td>Nombre maximum de lignes de données à lire</td>
</tr>
<tr class="odd">
<td><code>guess_max</code></td>
<td>
<code>1000</code> ou <code>n_max</code>
</td>
<td>Nombre de lignes utilisées pour deviner les types de colonnes</td>
</tr>
</tbody>
</table></section><section id="quelques-exemples-1" class="level4" data-number="14.2.3.2"><h4 data-number="14.2.3.2" class="anchored" data-anchor-id="quelques-exemples-1">
<span class="header-section-number">14.2.3.2</span> Quelques exemples</h4>
<p>Les exemples qui suivent vous présentent l’utilisation de la fonction <code>read_excel</code> dans quelques cas courants.</p>
<ul>
<li>
<strong>Utilisation la plus simple</strong> : on importe toutes les données du premier onglet, en supposant que la première ligne contient les noms de variables.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mesDonnees</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">chemin_xls</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mesDonnees</span>, <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 15
  Sheet1 Année `Population.en.milieu.d'année` Mariages `Divorces.prononcés.(a)`
  &lt;chr&gt;  &lt;chr&gt;                          &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;                   
1 1      1901                        40710000   316540 9000                    
2 2      1902                        40810000   306682 9600                    
3 3      1903                        40910000   308510 10400                   
# ℹ 10 more variables: Naissances.vivantes &lt;dbl&gt;, `Décès.tous.âges.(b)` &lt;dbl&gt;,
#   `Décès.de.moins.d'un.an` &lt;dbl&gt;, Excédent.naturel &lt;dbl&gt;,
#   `Nuptialité.(c)` &lt;dbl&gt;, Natalité &lt;dbl&gt;, Mortalité &lt;dbl&gt;,
#   Accroissement.naturel &lt;dbl&gt;,
#   Taux.de.mortalité.infantile.pour.1.000.naissances.vivantes &lt;dbl&gt;,
#   date &lt;chr&gt;</code></pre>
</div>
</div>
<ul>
<li>
<strong>Définir l’onglet à importer</strong> : on importe toutes les données du troisième onglet, en supposant que la première ligne contient les noms de variables. On définit l’onglet à importer avec le paramètre <code>sheet</code> en précisant soit le nom de l’onglet soit son index (sa position dans le fichier). Il est conseillé d’utiliser le nom de l’onglet plutôt que sa position.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Chargement du 3ème onglet</span></span>
<span><span class="va">mesDonnees</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">chemin_xls</span>, sheet <span class="op">=</span> <span class="st">"Sheet3"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>La fonction <code><a href="https://readxl.tidyverse.org/reference/excel_sheets.html">readxl::excel_sheets()</a></code> permet de récupérer les noms des onglets du fichier sans avoir à l’ouvrir.</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/excel_sheets.html">excel_sheets</a></span><span class="op">(</span><span class="va">chemin_xls</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sheet1" "Sheet2" "Sheet3"</code></pre>
</div>
</div>
</div>
</div>
<ul>
<li>
<strong>Importer une zone spécifique du fichier</strong> : il est possible de n’importer qu’une plage de cellules en la définissant dans l’argument <code>range</code>. On peut également préciser l’onglet concerné, en écrivant la zone sous la forme <code>"Sheet3!B2:D7"</code>. La première ligne de la plage est considérée comme <em>en-tête de colonnes</em>. Si ça n’est pas le cas, il faut ajouter le paramètre <code>col_names=FALSE</code> pour que la première ligne soit traitée comme une ligne de données.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mesDonnees</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">chemin_xls</span>, range <span class="op">=</span> <span class="st">"Sheet3!B2:D7"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mesDonnees</span>, <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  `1901` `40710000` `316540`
  &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;
1 1902     40810000   306682
2 1903     40910000   308510
3 1904     41000000   312134</code></pre>
</div>
</div>
<ul>
<li>
<strong>Définir le type des colonnes</strong> : le paramètre <code>col_types</code> permet de définir explicitement le type des colonnes et d’ignorer les colonnes qu’on ne souhaite pas importer. Pour cela, on passe au paramètre <code>col_types</code> un vecteur précisant le type parmi les possibilités suivantes :
<ul>
<li>
<code>"skip"</code> : ignorer la colonne (qui ne sera pas importée) ;</li>
<li>
<code>"guess"</code> : le type de la variable est devinée par rapport à ses <em>modalités</em> ;</li>
<li>
<code>"list"</code> : crée une liste ;</li>
<li>
<code>"logical</code> pour une variable booléenne, <code>"numeric"</code> pour une variable numérique, <code>"date"</code> pour une date et <code>"text"</code> pour une variable caractère.</li>
</ul>
Le type de la variable sera appliqué aux colonnes dans l’ordre défini par le vecteur. Exemple : <code>c("text","text","numeric","guess","skip","logical")</code>. Dans le cas où on souhaite définir le même type pour toutes les colonnes, il suffit de préciser une seule fois le type attendu (exemple <code>col_types = "text"</code>).</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mesDonnees</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">chemin_xls</span>, col_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"text"</span>,<span class="st">"list"</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"skip"</span>,<span class="fl">9</span><span class="op">)</span>, <span class="st">"text"</span>, <span class="st">"numeric"</span>, <span class="st">"text"</span>, <span class="st">"guess"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mesDonnees</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  Sheet1 Année     Mortalité  Accroissement.naturel Taux.de.mortalité.in…¹ date 
  &lt;chr&gt;  &lt;list&gt;    &lt;chr&gt;                      &lt;dbl&gt; &lt;chr&gt;                  &lt;chr&gt;
1 1      &lt;chr [1]&gt; 20.300000…                   2.2 151.09999999999999     2020…
2 2      &lt;chr [1]&gt; 19.600000…                   2.6 143.30000000000001     2020…
3 3      &lt;chr [1]&gt; 19.399999…                   2.2 145.30000000000001     2020…
4 4      &lt;chr [1]&gt; 19.600000…                   1.8 152.90000000000001     2020…
5 5      &lt;chr [1]&gt; 19.800000…                   1.3 144.5                  2020…
6 6      &lt;chr [1]&gt; 20                           1   151.5                  2020…
# ℹ abbreviated name:
#   ¹​Taux.de.mortalité.infantile.pour.1.000.naissances.vivantes</code></pre>
</div>
</div>
<ul>
<li>
<strong>Gestion des <code>NA</code> </strong> : il est possible de préciser les valeurs qu’on souhaite considérer comme des <code>NA</code> avec le paramètre <code>na</code>. Ici, pour l’exercice, la valeur <code>1902</code> est considérée comme <code>NA</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mesDonnees</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">chemin_xls</span>, na<span class="op">=</span><span class="st">"1902"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mesDonnees</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 15
  Sheet1 Année `Population.en.milieu.d'année` Mariages `Divorces.prononcés.(a)`
  &lt;chr&gt;  &lt;chr&gt;                          &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;                   
1 1      1901                        40710000   316540 9000                    
2 2      &lt;NA&gt;                        40810000   306682 9600                    
3 3      1903                        40910000   308510 10400                   
4 4      1904                        41000000   312134 11100                   
5 5      1905                        41050000   316195 11100                   
6 6      1906                        41100000   320208 11900                   
# ℹ 10 more variables: Naissances.vivantes &lt;dbl&gt;, `Décès.tous.âges.(b)` &lt;dbl&gt;,
#   `Décès.de.moins.d'un.an` &lt;dbl&gt;, Excédent.naturel &lt;dbl&gt;,
#   `Nuptialité.(c)` &lt;dbl&gt;, Natalité &lt;dbl&gt;, Mortalité &lt;dbl&gt;,
#   Accroissement.naturel &lt;dbl&gt;,
#   Taux.de.mortalité.infantile.pour.1.000.naissances.vivantes &lt;dbl&gt;,
#   date &lt;chr&gt;</code></pre>
</div>
</div>
<ul>
<li>
<strong>Ne pas importer les x premières lignes</strong> : le paramètre <code>skip</code> permet de définir le nombre de lignes à ignorer avant de commencer l’importation des données. Si on laisse le paramètre <code>col_names = TRUE</code>, la première des lignes importées est considérée comme noms de colonnes, ce qui peut donner des résultats absurdes. On peut alors utiliser le paramètre <code>col_names=FALSE</code> pour qu’elle ne soit pas considérée comme nom de variables.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mesDonnees</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">chemin_xls</span>, skip <span class="op">=</span> <span class="fl">5</span>, col_names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `` -&gt; `...1`
• `` -&gt; `...2`
• `` -&gt; `...3`
• `` -&gt; `...4`
• `` -&gt; `...5`
• `` -&gt; `...6`
• `` -&gt; `...7`
• `` -&gt; `...8`
• `` -&gt; `...9`
• `` -&gt; `...10`
• `` -&gt; `...11`
• `` -&gt; `...12`
• `` -&gt; `...13`
• `` -&gt; `...14`
• `` -&gt; `...15`</code></pre>
</div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mesDonnees</span>, <span class="fl">4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 15
  ...1  ...2      ...3   ...4 ...5    ...6   ...7   ...8  ...9 ...10 ...11 ...12
  &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 5     1905  41050000 316195 11100 865604 812338 125533 53266   7.7  21.1  19.8
2 6     1906  41100000 320208 11900 864745 820051 131058 44694   7.8  21    20  
3 7     1907  41100000 327723 12900 829632 830871 115501 -1239   8    20.2  20.2
4 8     1908  41190000 328877 13600 848982 784415 115556 64567   8    20.6  19  
# ℹ 3 more variables: ...13 &lt;dbl&gt;, ...14 &lt;dbl&gt;, ...15 &lt;chr&gt;</code></pre>
</div>
</div>
</section></section></section><section id="importer-un-fichier-ods-avec-le-package-readods" class="level2" data-number="14.3"><h2 data-number="14.3" class="anchored" data-anchor-id="importer-un-fichier-ods-avec-le-package-readods">
<span class="header-section-number">14.3</span> Importer un fichier <code>ods</code> avec le <em>package</em> <code>readODS</code>
</h2>
<section id="introduction" class="level3" data-number="14.3.1"><h3 data-number="14.3.1" class="anchored" data-anchor-id="introduction">
<span class="header-section-number">14.3.1</span> Introduction</h3>
<p>Le <em>package</em> <code>readODS</code> propose deux fonctions d’importation de fichiers <code>ods</code> : <code>read_ods</code> et <code>read.ods</code>. La documentation du <em>package</em> recommande d’utiliser <code>read_ods</code>. L’usage de cette fonction va être illustré à partir d’un jeu de données créé à partir de données présentes sur le site de l’Insee. Pour reproduire les exemples ci-dessous, vous devez :</p>
<ul>
<li>télécharger le jeu de données en format <code>ods</code> ici : <code>https://github.com/InseeFrLab/utilitR &gt; import_donnees_tabulees_tests</code> puis le sauvegarder sur votre poste ;</li>
<li>définir dans <code>R</code> le chemin du fichier nommé <code>chemin_ods</code>. Voici un exemple :</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Attention, cet exemple doit être adapté à votre environnement de travail</span></span>
<span><span class="va">chemin_ods</span> <span class="op">&lt;-</span> <span class="st">"C:/Users/mon_IDEP_Insee/Dossier_utilitR/mes_donnees/mes_donnees.ods"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il ne faut pas oublier de charger le <em>package</em> avec <code>library</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/readODS/">readODS</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="comment-utiliser-la-fonction-read_ods" class="level3" data-number="14.3.2"><h3 data-number="14.3.2" class="anchored" data-anchor-id="comment-utiliser-la-fonction-read_ods">
<span class="header-section-number">14.3.2</span> Comment utiliser la fonction <code>read_ods()</code>
</h3>
<p>Voici les principaux arguments et options de <code><a href="https://docs.ropensci.org/readODS/reference/read_ods.html">read_ods()</a></code> :</p>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 16%">
<col style="width: 67%">
</colgroup>
<thead><tr class="header">
<th>Argument</th>
<th>Valeur par défaut</th>
<th>Fonction</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>path</code></td>
<td>Aucune</td>
<td>Le chemin du fichier <code>ods</code> à importer</td>
</tr>
<tr class="even">
<td><code>sheet</code></td>
<td>1</td>
<td>Onglet à importer. Soit le nom de l’onglet, soit le numéro de l’onglet (utiliser de préférence le nom de l’onglet)</td>
</tr>
<tr class="odd">
<td><code>col_names</code></td>
<td><code>TRUE</code></td>
<td>Indique si la première ligne de l’onglet contient les noms des variables</td>
</tr>
<tr class="even">
<td><code>col_types</code></td>
<td><code>NULL</code></td>
<td>
<code>NULL</code> pour laisser <code>R</code> deviner le type des variables à partir de l’onglet ou se reporter à <code><a href="https://readr.tidyverse.org/reference/type_convert.html">readr::type_convert</a></code> pour spécifier le type des variables</td>
</tr>
<tr class="odd">
<td><code>na</code></td>
<td><code>""</code></td>
<td>Vecteur donnant les chaîne de caractères interprétées comme des valeurs manquantes. Par défaut, <code>read_ods</code> convertit les cellules vides en données manquantes</td>
</tr>
<tr class="even">
<td><code>skip</code></td>
<td><code>0</code></td>
<td>Le nombre de lignes du fichier de données à ignorer avant de commencer à importer les données</td>
</tr>
<tr class="odd">
<td><code>range</code></td>
<td><code>NULL</code></td>
<td>Sélection d’un rectangle à l’aide d’une plage de cellules de type Excel, comme <code>range = "D12:F15"</code>.</td>
</tr>
</tbody>
</table></section><section id="quelques-exemples-2" class="level3" data-number="14.3.3"><h3 data-number="14.3.3" class="anchored" data-anchor-id="quelques-exemples-2">
<span class="header-section-number">14.3.3</span> Quelques exemples</h3>
<p>Les exemples qui suivent vous présentent l’utilisation de la fonction <code>read_ods</code> dans quelques cas courants.</p>
<ul>
<li>
<strong>Utilisation la plus simple</strong> : on importe toutes les données du premier onglet, en supposant que la première ligne contient les noms de variables.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Chargement du 2ème onglet</span></span>
<span><span class="va">mesDonnees</span> <span class="op">&lt;-</span> <span class="fu">readODS</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/readODS/reference/read_ods.html">read_ods</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">chemin_ods</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mesDonnees</span>, <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 15
  Sheet1 Année `Population.en.milieu.d'année` Mariages `Divorces.prononcés.(a)`
   &lt;dbl&gt; &lt;chr&gt;                          &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;                   
1      1 1901                        40710000   316540 9000                    
2      2 1902                        40810000   306682 9600                    
3      3 1903                        40910000   308510 10400                   
# ℹ 10 more variables: Naissances.vivantes &lt;dbl&gt;, `Décès.tous.âges.(b)` &lt;dbl&gt;,
#   `Décès.de.moins.d'un.an` &lt;dbl&gt;, Excédent.naturel &lt;dbl&gt;,
#   `Nuptialité.(c)` &lt;dbl&gt;, Natalité &lt;dbl&gt;, Mortalité &lt;dbl&gt;,
#   Accroissement.naturel &lt;dbl&gt;,
#   Taux.de.mortalité.infantile.pour.1.000.naissances.vivantes &lt;dbl&gt;,
#   date &lt;date&gt;</code></pre>
</div>
</div>
<ul>
<li>
<strong>Définir l’onglet à importer</strong> : on importe toutes les données du troisième onglet, en supposant que la première ligne contient les noms de variables. On définit l’onglet à importer avec le paramètre <code>sheet</code> en précisant soit le nom de l’onglet soit son index (sa position dans le fichier). Il est conseillé d’utiliser le nom de l’onglet plutôt que sa position.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Chargement du 3ème onglet</span></span>
<span><span class="va">mesDonnees</span> <span class="op">&lt;-</span> <span class="fu">readODS</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/readODS/reference/read_ods.html">read_ods</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">chemin_ods</span>, sheet <span class="op">=</span> <span class="st">"Sheet3"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>La fonction <code><a href="https://docs.ropensci.org/readODS/reference/list_ods_sheets.html">readODS::list_ods_sheets()</a></code> permet de récupérer les noms des onglets du fichier sans avoir à l’ouvrir.</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">readODS</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/readODS/reference/list_ods_sheets.html">list_ods_sheets</a></span><span class="op">(</span><span class="va">chemin_ods</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sheet1" "Sheet2" "Sheet3"</code></pre>
</div>
</div>
</div>
</div>
<ul>
<li>
<strong>Ne pas importer les n premières lignes </strong> : le paramètre <code>skip</code> permet de préciser à compter de quelle ligne commencer l’importation. Dans l’exemple ci-dessous, on n’importe les données qu’à compter de la cinquième ligne. Si on laisse le paramètre <code>col_names = TRUE</code>, la première de ces lignes est considérée comme noms de colonnes, ce qui peut donner des résultats absurdes. Si c’est le cas, on peut utiliser le paramètre <code>col_names = FALSE</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mesDonnees</span> <span class="op">&lt;-</span> <span class="fu">readODS</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/readODS/reference/read_ods.html">read_ods</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">chemin_ods</span>, skip <span class="op">=</span> <span class="fl">5</span>, col_names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `` -&gt; `...1`
• `` -&gt; `...2`
• `` -&gt; `...3`
• `` -&gt; `...4`
• `` -&gt; `...5`
• `` -&gt; `...6`
• `` -&gt; `...7`
• `` -&gt; `...8`
• `` -&gt; `...9`
• `` -&gt; `...10`
• `` -&gt; `...11`
• `` -&gt; `...12`
• `` -&gt; `...13`
• `` -&gt; `...14`
• `` -&gt; `...15`</code></pre>
</div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#  Nom des colonnes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mesDonnees</span>, <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 15
   ...1 ...2      ...3   ...4 ...5    ...6   ...7   ...8  ...9 ...10 ...11 ...12
  &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     5 1905  41050000 316195 11100 865604 812338 125533 53266   7.7  21.1  19.8
2     6 1906  41100000 320208 11900 864745 820051 131058 44694   7.8  21    20  
3     7 1907  41100000 327723 12900 829632 830871 115501 -1239   8    20.2  20.2
# ℹ 3 more variables: ...13 &lt;dbl&gt;, ...14 &lt;dbl&gt;, ...15 &lt;date&gt;</code></pre>
</div>
</div>
<ul>
<li>
<strong>Importer une zone spécifique du fichier</strong> : il est possible de n’importer qu’une plage de cellules en la définissant dans l’argument <code>range</code>. On peut également préciser l’onglet concerné, en écrivant la zone sous la forme <code>"Sheet1!B2:D7"</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mesDonnees</span> <span class="op">&lt;-</span> <span class="fu">readODS</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/readODS/reference/read_ods.html">read_ods</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">chemin_ods</span>, range <span class="op">=</span> <span class="st">"Sheet1!B2:D7"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mesDonnees</span>, <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  `1901` `40710000` `316540`
   &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;
1   1902   40810000   306682
2   1903   40910000   308510
3   1904   41000000   312134</code></pre>
</div>
</div>
</section></section><section id="RessourcesImportXLSX" class="level2" data-number="14.4"><h2 data-number="14.4" class="anchored" data-anchor-id="RessourcesImportXLSX">
<span class="header-section-number">14.4</span> Pour en savoir plus</h2>
<ul>
<li>
<a href="https://cran.r-project.org/web/packages/openxlsx/openxlsx.pdf">Package <code>openxlsx</code></a> ;</li>
<li>
<a href="https://cran.r-project.org/web/packages/readxl/readxl.pdf">Package <code>readxl</code></a> ;</li>
<li>
<a href="https://cran.r-project.org/web/packages/readODS/readODS.pdf">Package <code>readODS</code></a> ;</li>
<li>
<a href="https://cran.r-project.org/web/packages/readr/vignettes/readr.html">vignette <code>readr</code></a>.</li>
</ul>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../03_Fiches_thematiques/Fiche_import_tables_sas.html" class="pagination-link" aria-label="Importer des tables SAS®">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Importer des tables SAS®</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../03_Fiches_thematiques/Fiche_import_fichiers_parquet.html" class="pagination-link" aria-label="Lire et écrire des fichiers Parquet">
        <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Lire et écrire des fichiers Parquet</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/InseeFrLab/utilitR/edit/master/03_Fiches_thematiques/Fiche_import_tableurs.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/InseeFrLab/utilitR/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<li>
<a href="https://github.com/InseeFrLab/utilitR.git" target="blank">Code source</a>
</li>
</div>
  </div>
</footer>


</body></html>
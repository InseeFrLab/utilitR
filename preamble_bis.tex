%%%%%%%%%%%%%%%%%%%%
% Des réglages issus de notre ancien préambule
%%%%%%%%%%%%%%%%%%%%

\usepackage{booktabs}
%  \usepackage{geometry}
%  \geometry{a4paper, margin=1in}
\usepackage[many]{tcolorbox}
\usepackage{color}

%  % La couleur des liens
%  \definecolor{link}{rgb}{0.1,0.1,0.8} %% blue with some grey
%  \usepackage{hyperref}
%  \hypersetup{
%    colorlinks = true,%
%    citecolor=link,%
%    filecolor=link,%
%    linkcolor=link,%
%    urlcolor=link
%  }

%\usepackage{tocloft}
%\renewcommand{\cfttoctitlefont}{\color{RoyalBlue}}()
%\renewcommand{\cftXfont}{\color{RoyalBlue}}()

% Autoriser les fiches à commencer sur n'importe quelle page
%  \makeatletter
%  \renewcommand\chapter{\clearpage
%                      \thispagestyle{plain}%
%                      \global\@topnum\z@
%                      \@afterindentfalse
%                      \secdef\@chapter\@schapter}
%  \makeatother

%  % Modifier le format des titres des fiches
%  \usepackage[raggedright]{titlesec}
%  \usepackage{blindtext}
%  \definecolor{gray75}{gray}{0.75}
%  \newcommand{\hsp}{\hspace{20pt}}
%  \titleformat{\chapter}[hang]{\raggedright\LARGE\bfseries}{\raggedright\thechapter\hsp\textcolor{gray75}{|}\hsp}{0pt}{\raggedright\LARGE\bfseries}

%  % Modifier les espaces autour des titres de fiches
%  \titlespacing*{\chapter}
%      {0pt}% left
%      {0cm}% before
%      {1cm}% after
%  
%  % Modifier les en-têtes et pieds de page
%  \usepackage{fancyhdr} 
%  \pagestyle{fancy} 
%  \cfoot{\thepage}
%  
%  \fancyhead{}
%  \fancyhead[RO, LE]{\leftmark}
%  \renewcommand\chaptermark[1]{\markboth{\thechapter . #1}{}}
%  %\renewcommand{\chaptermark}[1]{\markboth{#1}{}}


\definecolor{ffbaba}{RGB}{255, 186, 186}
\definecolor{ff0000}{RGB}{255, 0, 0}
\definecolor{a3dfff}{RGB}{163, 223, 255}
\definecolor{00a6ff}{RGB}{0, 166, 255}
\definecolor{fffcad}{RGB}{255, 252, 173}
\definecolor{ffe136}{RGB}{255, 225, 54}
\definecolor{e6f0ff}{RGB}{230, 240, 255}
\definecolor{4169e1}{RGB}{65, 105, 225}

\newtcolorbox{recommandation}{
  colback=ffbaba,
  colframe=ff0000,
  coltext=black,
  boxsep=5pt,
  arc=4pt} 

%  \newtcolorbox{conseil}{
%    colback=a3dfff,
%    colframe=00a6ff,
%    coltext=black,
%    boxsep=5pt,
%    arc=4pt} 
  
\newtcolorbox{remarque}{
  colback=fffcad,
  colframe=ffe136,
  coltext=black,
  boxsep=5pt,
  arc=4pt} 

\newtcolorbox{exercice}{
  colback=e6f0ff,
  colframe=4169e1,
  coltext=black,
  boxsep=5pt,
  arc=4pt} 


%%%%%%%%%%%%%%%%%%%%
% Des réglages issus du template:
% https://www.overleaf.com/project/5e7f5f46c51627000183d386
%%%%%%%%%%%%%%%%%%%%

\usepackage[a4paper, margin=1in,headsep=10pt]{geometry} % Page margins
\usepackage{xcolor,lipsum} % Required for specifying colors by name
\definecolor{ocre}{RGB}{51,102,0} 
\definecolor{lightgray}{RGB}{229,229,229} 

% Font Settings
\usepackage{avant} % Use the Avantgarde font for headings
%\usepackage{times} % Use the Times font for headings
\usepackage{mathptmx} % Use the Adobe Times Roman as the default text font together with math symbols from the Symbol, Chancery and Computer Modern fonts

\usepackage{microtype} % Slightly tweak font spacing for aesthetics
\usepackage[utf8]{inputenc} % Required for including letters with accents
\usepackage[T1]{fontenc} % Use 8-bit encoding that has 256 glyphs

% MATHS PACKAGE
\usepackage{amsmath,tikz}
\usetikzlibrary{matrix}
\newcommand*{\horzbar}{\rule[0.05ex]{2.5ex}{0.5pt}}
\usepackage{calc}

% VERBATIM PACKAGE
\usepackage{verbatim}

% Bibliography
% Tout est commenté ici car ça fait planter le code (et de toute façon ya pas de biblio)
%\usepackage[style=alphabetic,sorting=nyt,sortcites=true,autopunct=true,babel=hyphen,hyperref=true,abbreviate=false,backref=true,backend=biber]{biblatex}
%\addbibresource{bibliography.bib} % BibTeX bibliography file
%\defbibheading{bibempty}{}

%%%%%%%%%%%%%%%%%%%%
% Les réglages issus de structure.tex du template
%%%%%%%%%%%%%%%%%%%%
%----------------------------------------------------------------------------------------
  %	VARIOUS REQUIRED PACKAGES
%----------------------------------------------------------------------------------------
  
  \usepackage{titlesec} % Allows customization of titles

\usepackage{graphicx} % Required for including pictures
%\graphicspath{{Pictures/}} % Specifies the directory where pictures are stored

\usepackage{lipsum} % Inserts dummy text

\usepackage{tikz} % Required for drawing custom shapes

%\usepackage[english]{babel} % English language/hyphenation

\usepackage{enumitem} % Customize lists
\setlist{nolistsep} % Reduce spacing between bullet points and numbered lists

\usepackage{booktabs} % Required for nicer horizontal rules in tables

\usepackage{eso-pic} % Required for specifying an image background in the title page


%----------------------------------------------------------------------------------------
  %	MAIN TABLE OF CONTENTS
%----------------------------------------------------------------------------------------
  
  \usepackage{titletoc} % Required for manipulating the table of contents

\contentsmargin{0cm} % Removes the default margin
% Chapter text styling
\titlecontents{chapter}[1.25cm] % Indentation
{\addvspace{15pt}\large\sffamily\bfseries} % Spacing and font options for chapters
{\color{ocre!60}\contentslabel[\Large\thecontentslabel]{1.25cm}\color{ocre}} % Chapter number
{}  
{\color{ocre!60}\normalsize\sffamily\bfseries\;\titlerule*[.5pc]{.}\;\thecontentspage} % Page number
% Section text styling
\titlecontents{section}[1.25cm] % Indentation
{\addvspace{5pt}\sffamily\bfseries} % Spacing and font options for sections
{\contentslabel[\thecontentslabel]{1.25cm}} % Section number
{}
{\sffamily\hfill\color{black}\thecontentspage} % Page number
[]
% Subsection text styling
\titlecontents{subsection}[1.25cm] % Indentation
{\addvspace{1pt}\sffamily\small} % Spacing and font options for subsections
{\contentslabel[\thecontentslabel]{1.25cm}} % Subsection number
{}
{\sffamily\;\titlerule*[.5pc]{.}\;\thecontentspage} % Page number
[] 


%----------------------------------------------------------------------------------------
  %	MINI TABLE OF CONTENTS IN CHAPTER HEADS
%----------------------------------------------------------------------------------------
  
  % Section text styling
\titlecontents{lsection}[0em] % Indendating
{\footnotesize\sffamily} % Font settings
{}
{}
{}

% Subsection text styling
\titlecontents{lsubsection}[.5em] % Indentation
{\normalfont\footnotesize\sffamily} % Font settings
{}
{}
{}

%----------------------------------------------------------------------------------------
  %	PAGE HEADERS
%----------------------------------------------------------------------------------------
  
  \usepackage{fancyhdr} % Required for header and footer configuration

\pagestyle{fancy}
\renewcommand{\chaptermark}[1]{\markboth{\sffamily\normalsize\bfseries\chaptername\ \thechapter.\ #1}{}} % Chapter text font settings
  \renewcommand{\sectionmark}[1]{\markright{\sffamily\normalsize\thesection\hspace{5pt}#1}{}} % Section text font settings
    \fancyhf{} \fancyhead[LE,RO]{\sffamily\normalsize\thepage} % Font setting for the page number in the header
    \fancyhead[LO]{\rightmark} % Print the nearest section name on the left side of odd pages
    \fancyhead[RE]{\leftmark} % Print the current chapter name on the right side of even pages
    \renewcommand{\headrulewidth}{0.5pt} % Width of the rule under the header
    \addtolength{\headheight}{2.5pt} % Increase the spacing around the header slightly
    \renewcommand{\footrulewidth}{0pt} % Removes the rule in the footer
    \fancypagestyle{plain}{\fancyhead{}\renewcommand{\headrulewidth}{0pt}} % Style for when a plain pagestyle is specified
    
    % Removes the header from odd empty pages at the end of chapters
    \makeatletter
    \renewcommand{\cleardoublepage}{
      \clearpage\ifodd\c@page\else
        \hbox{}
      \vspace*{\fill}
      \thispagestyle{empty}
      \newpage
      \fi}

    %----------------------------------------------------------------------------------------
      %	THEOREM STYLES
    %----------------------------------------------------------------------------------------
      
      \usepackage{amsmath,amsfonts,amssymb,amsthm} % For math equations, theorems, symbols, etc
    
    \newcommand{\intoo}[2]{\mathopen{]}#1\,;#2\mathclose{[}}
      \newcommand{\ud}{\mathop{\mathrm{{}d}}\mathopen{}}
      \newcommand{\intff}[2]{\mathopen{[}#1\,;#2\mathclose{]}}
        \newtheorem{notation}{Notation}[chapter]
        
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %%%%%%%%%%%%%%%%%%%% dedicated to boxed/framed environements %%%%%%%%%%%%%%
          %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        \newtheoremstyle{ocrenumbox}% % Theorem style name
        {0pt}% Space above
        {0pt}% Space below
        {\normalfont}% % Body font
        {}% Indent amount
        {\small\bf\sffamily\color{ocre}}% % Theorem head font
        {\;}% Punctuation after theorem head
        {0.25em}% Space after theorem head
        {\small\sffamily\color{ocre}\thmname{#1}\nobreakspace\thmnumber{\@ifnotempty{#1}{}\@upn{#2}}% Theorem text (e.g. Theorem 2.1)
          \thmnote{\nobreakspace\the\thm@notefont\sffamily\bfseries\color{black}---\nobreakspace#3.}} % Optional theorem note
            \renewcommand{\qedsymbol}{$\blacksquare$}% Optional qed square
            
            \newtheoremstyle{blacknumex}% Theorem style name
            {5pt}% Space above
            {5pt}% Space below
            {\normalfont}% Body font
            {} % Indent amount
            {\small\bf\sffamily}% Theorem head font
            {\;}% Punctuation after theorem head
            {0.25em}% Space after theorem head
            {\small\sffamily{\tiny\ensuremath{\blacksquare}}\nobreakspace\thmname{#1}\nobreakspace\thmnumber{\@ifnotempty{#1}{}\@upn{#2}}% Theorem text (e.g. Theorem 2.1)
              \thmnote{\nobreakspace\the\thm@notefont\sffamily\bfseries---\nobreakspace#3.}}% Optional theorem note
                
                \newtheoremstyle{blacknumbox} % Theorem style name
                {0pt}% Space above
                {0pt}% Space below
                {\normalfont}% Body font
                {}% Indent amount
                {\small\bf\sffamily}% Theorem head font
                {\;}% Punctuation after theorem head
                {0.25em}% Space after theorem head
                {\small\sffamily\thmname{#1}\nobreakspace\thmnumber{\@ifnotempty{#1}{}\@upn{#2}}% Theorem text (e.g. Theorem 2.1)
                  \thmnote{\nobreakspace\the\thm@notefont\sffamily\bfseries---\nobreakspace#3.}}% Optional theorem note
                    
                    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                    %%%%%%%%%%%%% dedicated to non-boxed/non-framed environements %%%%%%%%%%%%%
                      %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                    \newtheoremstyle{ocrenum}% % Theorem style name
                    {5pt}% Space above
                    {5pt}% Space below
                    {\normalfont}% % Body font
                    {}% Indent amount
                    {\small\bf\sffamily\color{ocre}}% % Theorem head font
                    {\;}% Punctuation after theorem head
                    {0.25em}% Space after theorem head
                    {\small\sffamily\color{ocre}\thmname{#1}\nobreakspace\thmnumber{\@ifnotempty{#1}{}\@upn{#2}}% Theorem text (e.g. Theorem 2.1)
                      \thmnote{\nobreakspace\the\thm@notefont\sffamily\bfseries\color{black}---\nobreakspace#3.}} % Optional theorem note
                        \renewcommand{\qedsymbol}{$\blacksquare$}% Optional qed square
                        \makeatother
                        
                        % Defines the theorem text style for each type of theorem to one of the three styles above
                        \newcounter{dummy} 
                        \numberwithin{dummy}{section}
                        \theoremstyle{ocrenumbox}
                        \newtheorem{theoremeT}[dummy]{Theorem}
                        \newtheorem{problem}{Problem}[chapter]
                        \newtheorem{exerciseT}{Exercise}[chapter]
                        \theoremstyle{blacknumex}
                        \newtheorem{exampleT}{Example}[chapter]
                        \theoremstyle{blacknumbox}
                        \newtheorem{vocabulary}{Vocabulary}[chapter]
                        \newtheorem{definitionT}{Definition}[section]
                        \newtheorem{corollaryT}[dummy]{Corollary}
                        \theoremstyle{ocrenum}
                        \newtheorem{proposition}[dummy]{Proposition}
                        
                        %----------------------------------------------------------------------------------------
                          %	DEFINITION OF COLORED BOXES
                        %----------------------------------------------------------------------------------------
                          
                          \RequirePackage[framemethod=default]{mdframed} % Required for creating the theorem, definition, exercise and corollary boxes
                        
                        % Theorem box
                        \newmdenv[skipabove=7pt,
                                  skipbelow=7pt,
                                  backgroundcolor=black!5,
                                  linecolor=ocre,
                                  innerleftmargin=5pt,
                                  innerrightmargin=5pt,
                                  innertopmargin=5pt,
                                  leftmargin=0cm,
                                  rightmargin=0cm,
                                  innerbottommargin=5pt]{tBox}
                        
                        % Exercise box	  
                        \newmdenv[skipabove=7pt,
                                  skipbelow=7pt,
                                  rightline=false,
                                  leftline=true,
                                  topline=false,
                                  bottomline=false,
                                  backgroundcolor=ocre!10,
                                  linecolor=ocre,
                                  innerleftmargin=5pt,
                                  innerrightmargin=5pt,
                                  innertopmargin=5pt,
                                  innerbottommargin=5pt,
                                  leftmargin=0cm,
                                  rightmargin=0cm,
                                  linewidth=4pt]{eBox}	
                        
                        % Definition box
                        \newmdenv[skipabove=7pt,
                                  skipbelow=7pt,
                                  rightline=false,
                                  leftline=true,
                                  topline=false,
                                  bottomline=false,
                                  linecolor=ocre,
                                  innerleftmargin=5pt,
                                  innerrightmargin=5pt,
                                  innertopmargin=0pt,
                                  leftmargin=0cm,
                                  rightmargin=0cm,
                                  linewidth=4pt,
                                  innerbottommargin=0pt]{dBox}	
                        
                        % Corollary box
                        \newmdenv[skipabove=7pt,
                                  skipbelow=7pt,
                                  rightline=false,
                                  leftline=true,
                                  topline=false,
                                  bottomline=false,
                                  linecolor=gray,
                                  backgroundcolor=black!5,
                                  innerleftmargin=5pt,
                                  innerrightmargin=5pt,
                                  innertopmargin=5pt,
                                  leftmargin=0cm,
                                  rightmargin=0cm,
                                  linewidth=4pt,
                                  innerbottommargin=5pt]{cBox}
                        
                        % Creates an environment for each type of theorem and assigns it a theorem text style from the "Theorem Styles" section above and a colored box from above
                        \newenvironment{theorem}{\begin{tBox}\begin{theoremeT}}{\end{theoremeT}\end{tBox}}
                        \newenvironment{exercise}{\begin{eBox}\begin{exerciseT}}{\hfill{\color{ocre}\tiny\ensuremath{\blacksquare}}\end{exerciseT}\end{eBox}}				  
                        \newenvironment{conseil}{\begin{eBox}\begin{exerciseT}}{\hfill{\color{ocre}\tiny\ensuremath{\blacksquare}}\end{exerciseT}\end{eBox}}				                   
                        \newenvironment{definition}{\begin{dBox}\begin{definitionT}}{\end{definitionT}\end{dBox}}	
                        \newenvironment{example}{\begin{exampleT}}{\hfill{\tiny\ensuremath{\blacksquare}}\end{exampleT}}		
                        \newenvironment{corollary}{\begin{cBox}\begin{corollaryT}}{\end{corollaryT}\end{cBox}}	
                    
                        %----------------------------------------------------------------------------------------
                          %	REMARK ENVIRONMENT
                        %----------------------------------------------------------------------------------------
                          
                          \newenvironment{remark}{\par\vspace{10pt}\small % Vertical white space above the remark and smaller font size
                            \begin{list}{}{
                              \leftmargin=35pt % Indentation on the left
                              \rightmargin=25pt}\item\ignorespaces % Indentation on the right
                            \makebox[-2.5pt]{\begin{tikzpicture}[overlay]
                              \node[draw=ocre!60,line width=1pt,circle,fill=ocre!25,font=\sffamily\bfseries,inner sep=2pt,outer sep=0pt] at (-15pt,0pt){\textcolor{ocre}{R}};\end{tikzpicture}} % Orange R in a circle
                            \advance\baselineskip -1pt}{\end{list}\vskip5pt} % Tighter line spacing and white space after remark
                        
                        %----------------------------------------------------------------------------------------
                          %	SECTION NUMBERING IN THE MARGIN
                        %----------------------------------------------------------------------------------------
                          
                          \makeatletter
                        \renewcommand{\@seccntformat}[1]{\llap{\textcolor{ocre}{\csname the#1\endcsname}\hspace{1em}}}                    
                          \renewcommand{\section}{\@startsection{section}{1}{\z@}
                            {-4ex \@plus -1ex \@minus -.4ex}
                            {1ex \@plus.2ex }
                            {\normalfont\large\sffamily\bfseries}}
                          \renewcommand{\subsection}{\@startsection {subsection}{2}{\z@}
                            {-3ex \@plus -0.1ex \@minus -.4ex}
                            {0.5ex \@plus.2ex }
                            {\normalfont\sffamily\bfseries}}
                          \renewcommand{\subsubsection}{\@startsection {subsubsection}{3}{\z@}
                            {-2ex \@plus -0.1ex \@minus -.2ex}
                            {.2ex \@plus.2ex }
                            {\normalfont\small\sffamily\bfseries}}                        
                          \renewcommand\paragraph{\@startsection{paragraph}{4}{\z@}
                            {-2ex \@plus-.2ex \@minus .2ex}
                            {.1ex}
                            {\normalfont\small\sffamily\bfseries}}
                                              
                          %----------------------------------------------------------------------------------------
                            %	HYPERLINKS IN THE DOCUMENTS
                          %----------------------------------------------------------------------------------------
                            
                            % For an unclear reason, the package should be loaded now and not later
                          \usepackage{hyperref}
                          \hypersetup{hidelinks,backref=true,pagebackref=true,hyperindex=true,colorlinks=false,breaklinks=true,urlcolor= ocre,bookmarks=true,bookmarksopen=false,pdftitle={Title},pdfauthor={Author}}
                    
